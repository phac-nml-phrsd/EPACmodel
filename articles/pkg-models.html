<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EPACmodel">
<title>Package models • EPACmodel</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Package models">
<meta property="og:description" content="EPACmodel">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EPACmodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/EPACmodel.html">Get started</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pkg-models.html">Package models</a>
    <a class="dropdown-item" href="../articles/local-models.html">Locally-defined models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/phac-nml-phrsd/EPACmodel/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Package models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/phac-nml-phrsd/EPACmodel/blob/HEAD/vignettes/pkg-models.Rmd" class="external-link"><code>vignettes/pkg-models.Rmd</code></a></small>
      <div class="d-none name"><code>pkg-models.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="old-and-young-model">
<code>old-and-young</code> model<a class="anchor" aria-label="anchor" href="#old-and-young-model"></a>
</h3>
<p>This version of the model features a basic epidemiological structure
stratified with two age groups: young and old. The epidemiological
compartments are:</p>
<ul>
<li>
<span class="math inline">\(S\)</span>: susceptible</li>
<li>
<span class="math inline">\(E\)</span>: exposed</li>
<li>
<span class="math inline">\(I\)</span>: infected</li>
<li>
<span class="math inline">\(H\)</span>: hospitalized</li>
<li>
<span class="math inline">\(R\)</span>: recovered</li>
<li>
<span class="math inline">\(D\)</span>: dead</li>
</ul>
<p>The flows within each age group are as follows:</p>
<p><img src="figs/epi-flow-diagram.png"></p>
<p>The solid lines indicate flows between compartments and the dashed
lines indicate when a compartment is involved in calculating a flow
rate.</p>
<div class="section level4">
<h4 id="age-based-transmission">Age-based transmission<a class="anchor" aria-label="anchor" href="#age-based-transmission"></a>
</h4>
<p>The force of infection for age group <span class="math inline">\(i\)</span>, <span class="math inline">\(\lambda_i\)</span>, which is the per-capita rate
of flow of age <span class="math inline">\(i\)</span> susceptibles into
the exposed class (of the same age), is modelled as</p>
<p><span class="math display">\[
\lambda_i = \sum_{j} c_{ij} \beta_j I_j/N_j
\]</span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(c_{ij}\)</span> is the contact rate of a
susceptible in age group <span class="math inline">\(i\)</span> with an
infected in age group <span class="math inline">\(j\)</span>,</li>
<li>
<span class="math inline">\(\beta_j\)</span> is the transmission
rate for age group <span class="math inline">\(j\)</span>,</li>
<li>
<span class="math inline">\(I_j\)</span> is the number of infectious
individuals in age group <span class="math inline">\(j\)</span>,</li>
<li>
<span class="math inline">\(N_j\)</span> is the population size of
age group <span class="math inline">\(j\)</span>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="input-values">Input values<a class="anchor" aria-label="anchor" href="#input-values"></a>
</h4>
<p>There are several input values for the base model. Some inputs are
stratified by age group (with suffix <code>_y</code> for young and
<code>_o</code> for old). We use the generic suffix <code>_j</code> to
denote inputs for age group <code>j</code> in the list below:</p>
<ul>
<li>
<code>state</code>: a named list of the initial state for the
simulation, where the name of each state follows the pattern
<code>[epi-state]_j</code>
</li>
<li>
<code>params</code>: a named list of model parameters used to
compute flow rates, including
<ul>
<li>
<code>transmission_j</code>: transmission rate, denoted by <span class="math inline">\(\beta_j\)</span> in the force of infection
above,</li>
<li>
<code>c_ij</code>: contact rate, denoted by <span class="math inline">\(c_{ij}\)</span> in the force of infection
above,</li>
<li>
<code>progression_j</code>: rate of flow from exposed to
infectious,</li>
<li>
<code>recovery_j</code>: rate of flow from infectious to
recovered,</li>
<li>
<code>hospitalization_j</code>: rate of flow from infectious to
hospitalized,</li>
<li>
<code>discharge_j</code>: rate of from from hospitalized to
recovered,</li>
<li>
<code>deathH_j</code>: rate of flow from hospitalized to dead,</li>
<li>
<code>deathI_j</code>: rate of flow from infectious to dead.</li>
</ul>
</li>
</ul>
<p>Optional (scenario-specific) input values are documented in the <a href="#available-scenarios-tagm">next section</a>.</p>
</div>
<div class="section level4">
<h4 id="available-scenarios-tagm">Available scenarios<a class="anchor" aria-label="anchor" href="#available-scenarios-tagm"></a>
</h4>
<div class="section level5">
<h5 id="change-transmission-scenario">
<code>change-transmission</code> scenario<a class="anchor" aria-label="anchor" href="#change-transmission-scenario"></a>
</h5>
<p>This scenario simulates two changes in the age-dependent transmission
rates on specific days.</p>
<p>Intervention days are specified through the
<code>intervention.day</code> input value. The default values yield
changes on days 40 and 50.</p>
<p>Scalar multiples of the original transmission rates are specified via
the <code>trans.factor.young</code> and <code>trans.factor.old</code>
input values, for the young and old, respectively. The default values
reduce the transmission rate to 50% then 10% of the original value
across both age groups.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="five-year-age-group-model">
<code>five-year-age-group</code> model<a class="anchor" aria-label="anchor" href="#five-year-age-group-model"></a>
</h3>
<p>This version of the model features a basic epidemiological structure
stratified with five-year age groups up to age 80. The epidemiological
compartments are:</p>
<ul>
<li>
<span class="math inline">\(S\)</span>: susceptible</li>
<li>
<span class="math inline">\(E\)</span>: exposed</li>
<li>
<span class="math inline">\(I\)</span>: infected</li>
<li>
<span class="math inline">\(H\)</span>: hospitalized</li>
<li>
<span class="math inline">\(R\)</span>: recovered</li>
<li>
<span class="math inline">\(D\)</span>: dead</li>
</ul>
<p>The flows within each age group are as follows:</p>
<p><img src="figs/epi-flow-diagram.png"></p>
<p>The solid lines indicate flows between compartments and the dashed
lines indicate when a compartment is involved in calculating a flow
rate.</p>
<div class="section level4">
<h4 id="age-based-transmission-1">Age-based transmission<a class="anchor" aria-label="anchor" href="#age-based-transmission-1"></a>
</h4>
<p>The force of infection for age group <span class="math inline">\(i\)</span>, <span class="math inline">\(\lambda_i\)</span>, which is the per-capita rate
of flow of age <span class="math inline">\(i\)</span> susceptibles into
the exposed class (of the same age), is modelled as</p>
<p>The force of infection for occurs in an age-based way, as a proxy for
population heterogeneity. The transmission rate for susceptibles of age
<code>i</code> and infectious individuals of age <code>j</code> is
calculated as</p>
<p><span class="math display">\[
\lambda_i = \tau \sum_{j} p_{ij} \hat{c}_j I_j/N_j
\]</span></p>
<p>where</p>
<ul>
<li>
<span class="math inline">\(\tau\)</span> is the transmissibility of
the pathogen, quantified as the proportion of contacts between a
susceptible and an infectious individual that yield transmission
(independent of age),</li>
<li>
<span class="math inline">\(p_{ij}\)</span> is the proportion of age
group <span class="math inline">\(i\)</span>’s contacts that occur with
age group <span class="math inline">\(j\)</span>,</li>
<li>
<span class="math inline">\(\hat{c}_j\)</span> is the average
contact rate for individuals in age group <span class="math inline">\(j\)</span> (across all ages),</li>
<li>
<span class="math inline">\(I_j\)</span> is the number of infectious
individuals in age group <span class="math inline">\(j\)</span> (at a
given time),</li>
<li>
<span class="math inline">\(N_j\)</span> is the population size of
age group <span class="math inline">\(j\)</span>.</li>
</ul>
<p>The average contact rate vector (<span class="math inline">\(\hat{c}\)</span>) and the contact proportion
matrix (<span class="math inline">\(\left[p_{ij}\right]\)</span>) are
both generated using a weighted average of four setting-based component
contact matrices, derived by <a href="https://www.nature.com/articles/s41467-020-20544-y" class="external-link">Mistry et al
(2021)</a>, which reflect contacts in households, workplaces, schools,
and community (all other contacts outside of the three previous
settings). The weights are the average overall contact rate per setting.
This weighted average generates an overall contact matrix. The row sums
of this matrix give the average contact rate vector, <span class="math inline">\(\left[\hat{c}_j\right]\)</span>, and the
row-normalized version of this matrix is the contact proportion matrix
(<span class="math inline">\(\left[p_{ij}\right]\)</span>).</p>
</div>
<div class="section level4">
<h4 id="input-values-1">Input values<a class="anchor" aria-label="anchor" href="#input-values-1"></a>
</h4>
<p>There are several input values for the base model. Some inputs are
stratified by age group (with suffix <code>.lb[digit]</code>, where
<code>[digit]</code> denotes the lower bound of the age group. For
example, <code>.lb50</code> denotes the <code>50-54</code> age group. We
use the generic suffix <code>.j</code> to denote inputs for age group
<code>j</code> in the list below:</p>
<ul>
<li>
<code>state</code>: a named list of the initial state for the
simulation, where the name of each state follows the pattern
<code>[epi-state].j</code>
</li>
<li>
<code>flow</code>: a named list of flow rates, including
<ul>
<li>
<code>progression.j</code>: rate of flow from exposed to
infectious,</li>
<li>
<code>recovery.j</code>: rate of flow from infectious to
recovered,</li>
<li>
<code>hospitalization.j</code>: rate of flow from infectious to
hospitalized,</li>
<li>
<code>discharge.j</code>: rate of from from hospitalized to
recovered,</li>
<li>
<code>death_H.j</code>: rate of flow from hospitalized to dead,</li>
<li>
<code>death_I.j</code>: rate of flow from infectious to dead</li>
</ul>
</li>
<li>
<code>transmissibility</code>: transmissibility proportion, denoted
by <span class="math inline">\(\tau\)</span> in the force of infection
above,</li>
<li>
<code>setting.weight</code>: vector of weights for the
setting-specific component contact matrices, where each weight gives the
average contact rate per setting across all ages, as described
above.</li>
</ul>
<p>Optional (scenario-specific) input values are documented in the <a href="#available-scenarios-fyagm">next section</a>.</p>
</div>
<div class="section level4">
<h4 id="available-scenarios-fyagm">Available scenarios<a class="anchor" aria-label="anchor" href="#available-scenarios-fyagm"></a>
</h4>
<div class="section level5">
<h5 id="change-contacts-scenario">
<code>change-contacts</code> scenario<a class="anchor" aria-label="anchor" href="#change-contacts-scenario"></a>
</h5>
<p>This scenario enables the simulation of an intervention that affects
the age-based contact patterns starting on a specified day from the
start of the simulation (the “intervention day”).</p>
<p>The intervention day is specified with the
<code>intervention.day</code> input value. The default value simulates a
stay-at-home order starting on day 25.</p>
<p>An intervention involves using a new contact matrix starting on the
intervention day, which is generated with new setting weights, specified
in the <code>setting.weight.new</code> input value. The default values
reflect closing all schools, 50% of workplaces, and reducing community
contacts by 75% from the default <code>setting.weight</code> input
value.</p>
<p>The user can also change overall transmissibility of the pathogen
starting on the intervention day to some scalar multiple of the original
value via the <code>trans.factor</code> input value. The default values
include <code>trans.factor = 1</code>, so no change to underlying
transmissibility.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/papsti" class="external-link">Irena Papst</a>, <a href="https://github.com/wzmli" class="external-link">Michael WZ Li</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
